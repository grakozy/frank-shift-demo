      - name: SHFT
        id: ollama
        run: |
          DIFF_CONTENT=$(cat diff.txt)

          PROMPT="You are the SH/FT AI Review Agent running in demo mode.
          Ignore the diff if empty. Generate:
          - One humorous line about the PR
          - One serious-sounding AI code insight
          - A confidence score
          
          Diff (may be empty):
          $DIFF_CONTENT
          "

          echo "Running prompt:"
          echo "$PROMPT"

          # Collect full streaming output from Ollama
          RESULT=$(curl -s http://localhost:11434/api/generate \
            -d "{\"model\":\"llama3.2:1b-instruct-q4_K_M\", \"prompt\":\"$PROMPT\"}" \
            | jq -r '.. | .response? // empty' | tr -d '\n')

          # Fallback if empty
          if [ -z "$RESULT" ]; then
            RESULT="(Demo Fallback) The SH/FT Agent is online. No real diff detected â€” generating simulated review summary.
            - Joke: This PR is so clean it could pass a linting test in its sleep.
            - Insight: Refactor opportunities detected in imaginary modules.
            - Confidence: 92%"
          fi

          echo "summary<<EOF" >> $GITHUB_OUTPUT
          echo "$RESULT" >> $GITHUB_OUTPUT
          echo "EOF" >> $GITHUB_OUTPUT
